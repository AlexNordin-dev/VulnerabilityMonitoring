dotnet restore > $null
try {
    $result = dotnet list package --vulnerable --include-transitive
    Write-Output $result

    $high = $result | Select-String -Pattern 'High' -CaseSensitive
    $low = $result | Select-String -Pattern 'Low' -CaseSensitive
    $moderate = $result | Select-String -Pattern 'Moderate' -CaseSensitive
    $critical = $result | Select-String -Pattern 'Critical' -CaseSensitive
    
    if ($high -or $moderate -or $critical) {
        Write-Host "HighModerateCriticalVulnerabilitiesFound"
        exit 
    }
    elseif ($low) {
        Write-Host "LowLulnerabilityFound"
    }
    else {
        Write-Host "NoVulnerabilitiesFound."  
      
    }   
}
catch {
    Write-Host $_.Exception.Message
    exit 1
}

